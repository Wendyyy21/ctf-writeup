---
layout: single
title: "Oneliner"
categories: [CTF, cryptography]
permalink: /ctf/RECTF-2025/Cryptography/oneliner/
---

## Description:
Find the flag with oneline of python!

## Solution:
1. We are given the Python code below:
```
print([int.from_bytes(open("flag.txt","rb").read(),"big") * __import__("secrets").randbits(1024) for i in range(3)])
```
along with the integer output. <br>
2. Based on the Python code, the flag (which is converted into an integer) is multiplied by three different random 1024-bit integers, and these three values are given as the output. Hence, we have the following:
$$ c1 = flag * r1 $$
$$ c2 = flag * r2 $$
$$ c3 = flag * r3 $$
where c represents each integer value in the output and r represents the random 1024-bit integer. <br>
3. Taking the gcd of both sides,
$$ gcd(c1, c2, c3) = flag * gcd(r1, r2, r3) $$
4. Since it is highly likely that three random numbers are coprime (i.e. gcd = 1), we get:
$$ gcd(c1, c2, c3) = flag * 1 $$
5. So to find the flag, we just need to calculate the gcd of the three output values. I did it in Python:
```
from math import gcd
vals = [
1264128327026952883398969464250327348482487831129377213896128249328928124661461022279796918401395841731058465169624791468892716593518758698927203117265613088851359667927231978495561996126371977025948389678521393181200662255639506743429073526304508472455420775704094152670644826665833967863445180982232731607509517344767778186450624060312729382602527117967847618382290999370,
574208195459709789879037536297221311382792982952417507309562832202647750830920436825182742963027026761303548534846611803170660056673786817412610487291098302244306461325455119957022043962726035143120284618247017231929639200349213136178912861942931779876679841221231687142245681787223210072781534729060226611300340031800867992388236857060456202703575443577229308926221158306,
321883900275261128984484448772322338128981583535695951454946421229927484633881670489707541336809198975530828440407860094552801361928801142220688905190317200544432883518782063314018369148325826004795221413021608225378140374358646966037310373213515617189877186842687505806035762367745980321535305938737542675830474541797963076152367715573985260873071387245189503856262268999
]
flag_int = gcd(gcd(vals[0], vals[1]), vals[2])
flag_bytes = flag_int.to_bytes((flag_int.bit_length() + 7) // 8, "big")
print(flag_bytes.decode())
```
6. Oneline version:
```
print((lambda n: n.to_bytes((n.bit_length()+7)//8,"big").decode())(__import__("math").gcd(__import__("math").gcd(
1264128327026952883398969464250327348482487831129377213896128249328928124661461022279796918401395841731058465169624791468892716593518758698927203117265613088851359667927231978495561996126371977025948389678521393181200662255639506743429073526304508472455420775704094152670644826665833967863445180982232731607509517344767778186450624060312729382602527117967847618382290999370,
574208195459709789879037536297221311382792982952417507309562832202647750830920436825182742963027026761303548534846611803170660056673786817412610487291098302244306461325455119957022043962726035143120284618247017231929639200349213136178912861942931779876679841221231687142245681787223210072781534729060226611300340031800867992388236857060456202703575443577229308926221158306),
321883900275261128984484448772322338128981583535695951454946421229927484633881670489707541336809198975530828440407860094552801361928801142220688905190317200544432883518782063314018369148325826004795221413021608225378140374358646966037310373213515617189877186842687505806035762367745980321535305938737542675830474541797963076152367715573985260873071387245189503856262268999)))
```

## Flag:

RE:CTF{GCD_70_tH3_Re5Cu3!!}
